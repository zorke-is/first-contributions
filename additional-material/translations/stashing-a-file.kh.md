# លាក់ទុក

ចុះបើអ្នកកំពុងធ្វើការលើកូដធំមួយ ហើយភ្លាមៗនោះ អ្នកត្រូវប្តូរសាខាពីសាខាដែលអ្នកកំពុងធ្វើការបច្ចុប្បន្នទៅសាខាផ្សេងទៀត។ ដោយសារលេខកូដមិនពេញលេញ ហើយដោយគ្មានការធ្វើតេស្តណាមួយ អ្នកប្រហែលជាមិនចង់ធ្វើវាទេ។ ប៉ុន្តែអ្នកមិនអាចផ្លាស់ទីទៅសាខាផ្សេងទៀតដោយមិនធ្វើការផ្លាស់ប្តូរនោះទេ Git នឹងមិនអនុញ្ញាតឱ្យអ្នកបំបែកលំហូរនេះទេ។ តើយើងធ្វើអ្វីនៅពេលនោះ? តើ​យើង​ធ្វើ​ដូចម្តេច​ដើម្បី​ការពារ​ការ​ប្រព្រឹត្ត​ដែល​មិន​ចាំបាច់ ខណៈ​ដែល​អាច​លោត​មែក​បាន? នេះជាអ្វីដែលមេរៀននេះគ្របដណ្តប់។

## លាក់ការងាររបស់អ្នក។

ឧបមាថាអ្នកកំពុងធ្វើការលើសាខារបស់គម្រោងដែលអ្នកបានផ្លាស់ប្តូរឯកសារមួយចំនួន។ ឥឡូវនេះ ប្រសិនបើអ្នកដំណើរការ `` ``ស្ថានភាព git`` អ្នកអាចឃើញការផ្លាស់ប្តូររបស់អ្នកនៅក្នុងឯកសារ។

```
$ git status
# នៅលើមេសាខា
# ការផ្លាស់ប្តូរដែលត្រូវប្តេជ្ញាចិត្ត៖
#   (use "git reset HEAD <file>..." to unstage)
#
#      modified:   index.html
#
# ការ​ផ្លាស់​ប្តូ​រ​មិន​បាន​រៀបចំ​សម្រាប់​ការ​ប្តេ​ជ្ញា​ចិត្ត​:
#   (ប្រើ "git add <file> ... " ដើម្បីធ្វើបច្ចុប្បន្នភាពនូវអ្វីដែលនឹងត្រូវប្តេជ្ញាចិត្ត)
#
#      modified:   lib/simplegit.rb
#
```

ឥឡូវនេះ អ្នកចង់ប្តូរសាខារបស់អ្នក ប៉ុន្តែមិនចង់ធ្វើការផ្លាស់ប្តូរនៅឡើយទេ។ ដូច្នេះអ្នកនឹងរក្សាទុកការផ្លាស់ប្តូរ។
ដើម្បីរុញកន្លែងផ្ទុកថ្មីទៅជង់របស់អ្នក សូមដំណើរការ ```git stash```៖

```
$ git stash
បានរក្សាទុកថតការងារ និងស្ថានភាពលិបិក្រម \
  "WIP on master: 049d078 បានបន្ថែមឯកសារលិបិក្រម "
ឥឡូវនេះ HEAD គឺនៅ 049d078 បានបន្ថែមឯកសារលិបិក្រម
(ដើម្បីស្ដារពួកវាវាយ "git stash apply")
```

ឥឡូវនេះថតការងាររបស់អ្នកស្អាតហើយ សូមប្រើ ```git status```:

```
$ git status
# នៅលើមេសាខា
គ្មាន​អ្វី​ត្រូវ​ប្រព្រឹត្ត​ទេ ថត​ការងារ​ស្អាត
```

ឥឡូវនេះអ្នកអាចប្តូរទៅសាខាណាមួយហើយធ្វើការងាររបស់អ្នក; ការផ្លាស់ប្តូរដែលបានរក្សាទុករបស់អ្នកត្រូវបានរក្សាទុកក្នុងទម្រង់ជាជង់។ ដើម្បី​មើល​ថា stashes មួយ​ណា​ដែល​អ្នក​បាន​រក្សា​ទុក​ក្នុង​ជង់​អ្នក​អាច​ប្រើ ``` git stash list```៖

```
$ git stash list
stash@{0}: WIP on master: 049d078 បានបន្ថែមឯកសារលិបិក្រម
stash@{1}: WIP on master: c264051 ត្រឡប់ "added file_size"
stash@{2}: WIP on master: 21d80a5 បានបន្ថែមលេខទៅកំណត់ហេតុ
```

ក្នុងករណីដែលអ្នកចង់អនុវត្តការផ្លាស់ប្ដូរដែលអ្នកទើបតែរក្សាទុកឡើងវិញ អ្នកអាចប្រើពាក្យបញ្ជា ```git stash apply```។ ដោយប្រើពាក្យបញ្ជានេះ អ្នកអាចអនុវត្តឡើងវិញនូវឯកសារដែលបានរក្សាទុកថ្មីៗបំផុត។ ដើម្បីអនុវត្តឯកសារផ្សេងទៀតឡើងវិញ អ្នកអាចបញ្ជាក់វាដោយដាក់ឈ្មោះវាដូចជា៖ ```git stash apply <stash-name>``` ជំនួសឱ្យ ```<stash-name>``` សរសេរឈ្មោះរបស់ កន្លែងទុកអ្នកត្រូវដាក់ពាក្យម្តងទៀត។

```
$ git stash apply
# លើប្រធានសាខា
# ការផ្លាស់ប្តូរមិនដំណើរការសម្រាប់ការប្តេជ្ញាចិត្ត៖
#   (ប្រើ "git add <file> ... " ដើម្បីធ្វើបច្ចុប្បន្នភាពនូវអ្វីដែលនឹងត្រូវប្តេជ្ញាចិត្ត)
#
#      modified:   index.html
#      modified:   lib/simplegit.rb
#
```

អ្នក​អាច​ឃើញ​ថា git កែប្រែ​ឯកសារ​ដែល​អ្នក​មិន​បាន​អនុញ្ញាត​ឡើង​វិញ​នៅ​ពេល​ដែល​អ្នក​រក្សា​ទុក​កន្លែង​ទុក។ ក្នុងករណីនេះ អ្នកមានថតការងារស្អាត នៅពេលអ្នកព្យាយាមអនុវត្តកន្លែងរក្សាទុក ហើយអ្នកព្យាយាមអនុវត្តវានៅលើសាខាដូចគ្នាដែលអ្នកបានរក្សាទុកវាពី។ ប៉ុន្តែ​ការ​មាន​ថត​ឯកសារ​ដែល​ដំណើរការ​ស្អាត​ហើយ​ការ​អនុវត្ត​វា​នៅ​លើ​សាខា​ដដែល​គឺ​មិន​ចាំបាច់​ដើម្បី​អនុវត្ត​កន្លែង​ទុក​ដោយ​ជោគជ័យ​នោះ​ទេ។ អ្នកអាចរក្សាទុកកន្លែងរក្សាទុកនៅលើសាខាមួយ ប្តូរទៅសាខាមួយទៀតនៅពេលក្រោយ ហើយអនុវត្តការផ្លាស់ប្ដូរនៅក្នុងសាខាថ្មីឡើងវិញ។ អ្នកក៏អាចមានឯកសារដែលបានកែប្រែ និងមិនបានអនុញ្ញាតនៅក្នុងថតការងាររបស់អ្នក នៅពេលអ្នកអនុវត្ត stash មួយ git ផ្តល់នូវការប៉ះទង្គិចគ្នាប្រសិនបើអ្វីៗលែងអនុវត្តបានស្អាត។

ការផ្លាស់ប្តូរដែលបានធ្វើឡើងចំពោះឯកសាររបស់អ្នកត្រូវបានអនុវត្តម្តងទៀត ប៉ុន្តែឯកសារដែលអ្នកបានរៀបចំមិនត្រូវបានស្តារឡើងវិញទេ។ ដើម្បីធ្វើដូច្នេះអ្នកត្រូវដំណើរការពាក្យបញ្ជា ```git stash apply``` ជាមួយ ```--index``` ដើម្បីប្រាប់ពាក្យបញ្ជាឱ្យអនុវត្តការផ្លាស់ប្តូរជាដំណាក់កាលឡើងវិញ។ ប្រសិនបើអ្នកបានដំណើរការវាជំនួសវិញ អ្នកនឹងត្រលប់ទៅទីតាំងដើមរបស់អ្នកវិញ៖

```
$ git stash apply --index
# លើប្រធានសាខា
# ការផ្លាស់ប្តូរមិនដំណើរការសម្រាប់ការប្តេជ្ញាចិត្ត៖
#   (ប្រើ "git reset HEAD <file> ... " ដើម្បី unstage)
#
#      modified:   index.html
#
# ការផ្លាស់ប្តូរមិនដំណើរការសម្រាប់ការប្តេជ្ញាចិត្ត៖
#   (ប្រើ "git add <file> ... " ដើម្បីធ្វើបច្ចុប្បន្នភាពអ្វីដែលនឹងត្រូវប្តេជ្ញាចិត្ត)
#
#      modified:   lib/simplegit.rb
#
```

ពាក្យបញ្ជាអនុវត្តអនុវត្តតែការងារដែលបានរក្សាទុកប៉ុណ្ណោះ ប៉ុន្តែអ្នកនៅតែមានវានៅលើជង់របស់អ្នក។ ដើម្បីលុបវាចេញ អ្នកអាចដំណើរការ ```git stash drop``` ដោយប្រើឈ្មោះរបស់ stash ដើម្បីលុបចេញ។

```
$ git stash list
stash@{0}: WIP on master: 049d078 បានបន្ថែមឯកសារលិបិក្រម
stash@{1}: WIP on master: c264051 ត្រឡប់ "added file_size"
stash@{2}: WIP on master: 21d80a5 បានបន្ថែមលេខទៅកំណត់ហេតុ
$ git stash drop stash@{0}
Dropped stash@{0} (364e91f3f268f0900bc3ee613f9f733e82aaed43)
```

អ្នកអាចប្រើ ```git stash pop`` ដើម្បីលុបការផ្លាស់ប្ដូរចុងក្រោយទម្លាក់វាចេញពីជង់របស់ stash របស់អ្នក។

## ឈប់អនុវត្ត ស្តុកទុក

ក្នុងករណីខ្លះអ្នកចង់អនុវត្តការផ្លាស់ប្តូរដែលបានរក្សាទុក សូមធ្វើការងារខ្លះ ប៉ុន្តែអនុវត្តការផ្លាស់ប្ដូរដែលមានដើមកំណើតចេញពីឃ្លាំង។ Git មិនផ្តល់ពាក្យបញ្ជាដូចជា ```git unapply``` ទេ ប៉ុន្តែវាអាចធ្វើទៅបានដើម្បីសម្រេចបាននូវប្រសិទ្ធិភាពនេះដោយគ្រាន់តែទាញយកបំណះដែលភ្ជាប់ជាមួយ stash ហើយអនុវត្តវាបញ្ច្រាស់៖

```$ git stash show -p stash@{0} | git apply -R```

ម្តងទៀត ប្រសិនបើអ្នកមិនបញ្ជាក់កន្លែងទុកទេ Git សន្មត់ថា stash ថ្មីបំផុត៖

```$ git stash show -p | git apply -R```

អ្នកប្រហែលជាចង់បង្កើតឈ្មោះក្លែងក្លាយ និងបន្ថែមពាក្យបញ្ជា `` `stash-unapply`` យ៉ាងមានប្រសិទ្ធភាពទៅ Git របស់អ្នក។ ឧទាហរណ៍:

```
$ git config --global alias.stash-unapply '!git stash show -p | git apply -R'
$ git stash ត្រូវបានអនុវត្
$ #... ការងារ ការងារ ការងារ
$ git stash-unapply
```

## ការបង្កើតសាខាពីឃ្លាំង

ប្រសិនបើអ្នកទុកការងារមួយចំនួន ទុកវានៅទីនោះមួយរយៈ ហើយបន្តទៅសាខាដែលអ្នកបានទុកការងារនោះ អ្នកអាចមានបញ្ហាក្នុងការអនុវត្តការងារឡើងវិញ។ ប្រសិនបើកម្មវិធីព្យាយាមកែប្រែឯកសារដែលអ្នកបានកែប្រែតាំងពីពេលនោះមក អ្នកនឹងទទួលបានការប៉ះទង្គិចគ្នា ហើយនឹងត្រូវដោះស្រាយវា។ ប្រសិនបើ​អ្នក​ចង់​បាន​វិធី​ងាយស្រួល​ជាង​មុន​ក្នុង​ការ​សាកល្បង​ការ​ផ្លាស់​ប្តូរ​ដែល​បាន​ទុក​ជា​ថ្មី​ម្តង​ទៀត អ្នក​អាច​ដំណើរ​ការ ```git stash branch``` ដែល​បង្កើត​សាខា​ថ្មី​សម្រាប់​អ្នក ពិនិត្យ​មើល​ការ​ប្តេជ្ញា​ចិត្ត​ដែល​អ្នក​បាន​ធ្វើ​នៅ​ពេល​ដែល​អ្នក​ទុក​ការងារ​របស់​អ្នក អនុវត្ត​របស់​អ្នក​ឡើង​វិញ។ ធ្វើការនៅទីនោះ ហើយបន្ទាប់មកទម្លាក់កន្លែងទុកប្រសិនបើវាអនុវត្តដោយជោគជ័យ៖

```
$ git stash branch testchanges
បានប្តូរទៅសាខាថ្មី "testchanges"
# នៅលើការផ្លាស់ប្តូរសាខា
# ការផ្លាស់ប្តូរដែលត្រូវប្តេជ្ញា៖
#   (ប្រើ "git reset HEAD <file> ... " ដើម្បី unstage)
#
#      modified:   index.html
#
# ការផ្លាស់ប្តូរមិនដំណើរការសម្រាប់ការប្តេជ្ញាចិត្ត៖
#   (ប្រើ "git add <file> ... " ដើម្បីធ្វើបច្ចុប្បន្នភាពអ្វីដែលនឹងត្រូវប្តេជ្ញាចិត្ត)
#
#      modified:   lib/simplegit.rb
#
Dropped refs/stash@{0} (f0dfc4d5dc332d1cee34a634182e168c4efc3359)
```

នេះ​ជា​ផ្លូវកាត់​ដ៏​ល្អ​មួយ​ដើម្បី​ស្ដារ​ការងារ​ដែល​បាន​រក្សាទុក​បាន​យ៉ាង​ងាយ​ស្រួល ហើយ​ធ្វើការ​លើ​វា​ក្នុង​សាខា​ថ្មី។